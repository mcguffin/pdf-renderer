!function(l,r,o){var n,d={view:{}},c=r.l10n;n=wp.media.View.extend({template:wp.template("pdf-page-item"),className:"pdf-page-item",initialize:function(){return wp.media.View.prototype.initialize.apply(this,arguments)},render:function(){return wp.media.View.prototype.render.apply(this,arguments)}}),d.view.PDFFrame=wp.media.view.MediaFrame.extend({template:wp.template("pdf-modal"),regions:["title","content","instructions","buttons","pagenav"],events:{"click [data-page]":"clickPage"},initialize:function(){return _.defaults(this.options,{uploader:!1,title:c.pdfUpload}),wp.media.view.MediaFrame.prototype.initialize.apply(this,arguments),this._pdf=this._canvas=null,this._current_page=0,this._pages={},this.createTitle(),this.createButtons(),this},createTitle:function(){this._title=new wp.media.View({tagName:"h1"}),this._title.$el.text(this.options.title),this.title.set([this._title])},createButtons:function(){var e=this;this.buttons.set([new wp.media.view.Button({text:c.CancelUpload,className:"cancel-upload",click:function(){e.trigger("cancel-upload"),e.close()}}),new wp.media.view.Button({text:c.UploadPDF,className:"upload-pdf",click:function(){}}),new wp.media.view.Button({text:c.UploadImages,className:"button-primary",click:function(){e.trigger("cancel-upload"),e.uploadImages(),e.close()}})])},setFile:function(e){var t=this,a=new FileReader;return this.file=e,a.onload=function(e){t.parsePDF(e.target.result)},a.readAsArrayBuffer(e.blob),this},clickPage:function(e){this.showPage(l(e.target).attr("data-page"))},renderPageNav:function(e){console.log();var t=this,a=1,i=[];for(this._pages={};a<=e;a++)this._pages[a]={page:!1,canvas:!1,selected:!0},i.push(new n({pagenum:a,selected:!0,events:{click:function(e){l(e.target).is(".dashicons")&&t.togglePage(this.options.pagenum),t.showPage(this.options.pagenum)}}}));this.pagenav.set(i)},parsePDF:function(e){var t=this;pdfjsLib.getDocument(e).then(function(e){t._pdf=e,t.renderPageNav(e.numPages),t.showPage(1)})},togglePage:function(e){this._pages[e].selected=!this._pages[e].selected,_.each(this._pages,function(e,t){console.log(t,e)})},showPage:function(e){var t=this;this._pages[e].canvas?this.content.set([new wp.media.View({el:this._pages[e].canvas})]):this.renderPage(e,function(){t.showPage(e)})},renderPage:function(n,o,s){var p=this;p._pdf.getPage(n).then(function(e){var t=e.getViewport(1),a=l("<canvas></canvas>").get(0),i=a.getContext("2d");t=e.getViewport(r.options.image_width/t.width),a.width=t.width,a.height=t.height,e.render({canvasContext:i,viewport:t}).then(function(){p._pages[n].page=e,p._pages[n].canvas=a,o&&o.apply(p._pages[n],s||[])})})},uploadImages:function(){var i=this,a="image/png",n=function(e){var t=new o.Image;t.onload=function(){t.name=e,t.type=a,i.options.uploader.addFile(t.getAsBlob(),e)},t.load(this.canvas.toDataURL(a)),l("body").append(t)};_.each(this._pages,function(e,t){var a=i.file.file.name.replace(/\.[a-z0-9]+$/,"")+"-p"+t+".png";e.canvas?n.apply(e):i.renderPage(1*t,n,[a])})}}),_.extend(wp.media.view.UploaderWindow.prototype,{_parentReady:wp.media.view.UploaderWindow.prototype.ready,didReady:!1,ready:function(){var s,p=[];if(this.didReady)return this._parentReady.apply(this,arguments);return this.didReady=!0,ret=this._parentReady.apply(this,arguments),this.uploader.uploader.bind("FilesAdded",function(e,t){for(var a,i,n,o=0;o<t.length;o++)"application/pdf"==t[o].type&&(i=t[o],n=void 0,(n={file:i,blob:i.getNative()}).blob||(n.blob=i.getSource()),(a=n).blob instanceof Blob&&p.push(a));p.length&&(e.stop(),e.refresh(),function e(t){var a;s&&s.close().dispose(),p.length?(a=p.shift(),(s=new d.view.PDFFrame({controller:l(this),uploader:t,title:c.Upload+": "+a.file.name.replace(/\.[a-z0-9]+$/,"")})).on("proceed",function(){e(t)}).on("cancel-upload",function(){a.file.attachment.destroy()}),s.setFile(a),s.open()):t.start()}(e))}),this.uploader.uploader.bind("BeforeUpload",function(e,t){}),ret}})}(jQuery,pdf_renderer,mOxie);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lZGlhLmpzIl0sIm5hbWVzIjpbIiQiLCJvcHRzIiwibyIsIlBhZ2VJdGVtIiwicGRmUmVuZGVyZXIiLCJ2aWV3IiwibDEwbiIsIndwIiwibWVkaWEiLCJWaWV3IiwiZXh0ZW5kIiwidGVtcGxhdGUiLCJjbGFzc05hbWUiLCJpbml0aWFsaXplIiwicHJvdG90eXBlIiwiYXBwbHkiLCJ0aGlzIiwiYXJndW1lbnRzIiwicmVuZGVyIiwiUERGRnJhbWUiLCJNZWRpYUZyYW1lIiwicmVnaW9ucyIsImV2ZW50cyIsImNsaWNrIFtkYXRhLXBhZ2VdIiwiXyIsImRlZmF1bHRzIiwib3B0aW9ucyIsInVwbG9hZGVyIiwidGl0bGUiLCJwZGZVcGxvYWQiLCJfcGRmIiwiX2NhbnZhcyIsIl9jdXJyZW50X3BhZ2UiLCJfcGFnZXMiLCJjcmVhdGVUaXRsZSIsImNyZWF0ZUJ1dHRvbnMiLCJfdGl0bGUiLCJ0YWdOYW1lIiwiJGVsIiwidGV4dCIsInNldCIsInNlbGYiLCJidXR0b25zIiwiQnV0dG9uIiwiQ2FuY2VsVXBsb2FkIiwiY2xpY2siLCJ0cmlnZ2VyIiwiY2xvc2UiLCJVcGxvYWRQREYiLCJVcGxvYWRJbWFnZXMiLCJ1cGxvYWRJbWFnZXMiLCJzZXRGaWxlIiwiZmlsZSIsImZpbGVSZWFkZXIiLCJGaWxlUmVhZGVyIiwib25sb2FkIiwiZXZlbnQiLCJwYXJzZVBERiIsInRhcmdldCIsInJlc3VsdCIsInJlYWRBc0FycmF5QnVmZmVyIiwiYmxvYiIsImNsaWNrUGFnZSIsImUiLCJzaG93UGFnZSIsImF0dHIiLCJyZW5kZXJQYWdlTmF2IiwibnVtUGFnZXMiLCJjb25zb2xlIiwibG9nIiwiaSIsImJ0bnMiLCJwYWdlIiwiY2FudmFzIiwic2VsZWN0ZWQiLCJwdXNoIiwicGFnZW51bSIsImlzIiwidG9nZ2xlUGFnZSIsInBhZ2VuYXYiLCJhcnIiLCJwZGZqc0xpYiIsImdldERvY3VtZW50IiwidGhlbiIsInBkZiIsImlkeCIsImVhY2giLCJlbCIsImNvbnRlbnQiLCJyZW5kZXJQYWdlIiwiY2IiLCJjYl9hcmdzIiwiZ2V0UGFnZSIsInZwIiwiZ2V0Vmlld3BvcnQiLCJnZXQiLCJjdHgiLCJnZXRDb250ZXh0IiwiaW1hZ2Vfd2lkdGgiLCJ3aWR0aCIsImhlaWdodCIsImNhbnZhc0NvbnRleHQiLCJ2aWV3cG9ydCIsInR5cGUiLCJ1cGxvYWQiLCJuYW1lIiwiaW1nIiwiSW1hZ2UiLCJhZGRGaWxlIiwiZ2V0QXNCbG9iIiwibG9hZCIsInRvRGF0YVVSTCIsImFwcGVuZCIsInBnIiwicmVwbGFjZSIsIlVwbG9hZGVyV2luZG93IiwiX3BhcmVudFJlYWR5IiwicmVhZHkiLCJkaWRSZWFkeSIsInBkZk1vZGFsIiwicGRmcyIsInJldCIsImJpbmQiLCJ1cCIsImZpbGVzIiwiZmlsZURhdGEiLCJfcmV0IiwibGVuZ3RoIiwiZ2V0TmF0aXZlIiwiZ2V0U291cmNlIiwiQmxvYiIsInN0b3AiLCJyZWZyZXNoIiwicGRmUG9wdXAiLCJmaWxlSXRlbSIsImRpc3Bvc2UiLCJzaGlmdCIsImNvbnRyb2xsZXIiLCJVcGxvYWQiLCJvbiIsImF0dGFjaG1lbnQiLCJkZXN0cm95Iiwib3BlbiIsInN0YXJ0IiwialF1ZXJ5IiwicGRmX3JlbmRlcmVyIiwibU94aWUiXSwibWFwcGluZ3MiOiJDQUFBLFNBQVdBLEVBQUdDLEVBQU1DLEdBRW5CLElBS0NDLEVBTEdDLEVBQWMsQ0FDaEJDLEtBQU0sSUFFUEMsRUFBT0wsRUFBS0ssS0FLYkgsRUFBV0ksR0FBR0MsTUFBTUMsS0FBS0MsT0FBTyxDQUMvQkMsU0FBV0osR0FBR0ksU0FBUyxpQkFDdkJDLFVBQVUsZ0JBQ1ZDLFdBQVcsV0FDVixPQUFPTixHQUFHQyxNQUFNQyxLQUFLSyxVQUFVRCxXQUFXRSxNQUFNQyxLQUFLQyxZQUV0REMsT0FBTyxXQUNOLE9BQU9YLEdBQUdDLE1BQU1DLEtBQUtLLFVBQVVJLE9BQU9ILE1BQU1DLEtBQUtDLGNBSW5EYixFQUFZQyxLQUFLYyxTQUFXWixHQUFHQyxNQUFNSCxLQUFLZSxXQUFXVixPQUFPLENBQzNEQyxT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LEVBQVcsSUFBSW5ILEVBQVlDLEtBQUtjLFNBQVUsQ0FDekNzSCxXQUFZekksRUFBRWdCLE1BQ2RXLFNBQVNBLEVBQ1RDLE1BQU90QixFQUFLb0ksT0FBUyxLQUFPSixFQUFTbEYsS0FBS3FELEtBQUtTLFFBQVEsZUFBZSxPQUU5RHlCLEdBQUcsVUFBVSxXQUVyQk4sRUFBVTFHLEtBRVJnSCxHQUFHLGdCQUFnQixXQUNyQkwsRUFBU2xGLEtBQUt3RixXQUFXQyxZQUUxQnRCLEVBQVNwRSxRQUFTbUYsR0FDbEJmLEVBQVN1QixRQUVUbkgsRUFBU29ILFFBcUNUVixDQUFVVixNQUlaM0csS0FBS1csU0FBU0EsU0FBUytGLEtBQUssZUFBZSxTQUFVQyxFQUFJdkUsTUFJbERxRSxPQTlVVixDQWtWSXVCLE9BQVFDLGFBQWNDIiwiZmlsZSI6ImFkbWluL21lZGlhLmRldi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiggJCwgb3B0cywgbyApIHtcblxuXHR2YXIgcGRmUmVuZGVyZXIgPSB7XG5cdFx0XHR2aWV3OiB7fVxuXHRcdH0sXG5cdFx0bDEwbiA9IG9wdHMubDEwbixcblx0XHRpbWFnZUluZm9zID0ge30sXG5cdFx0UGFnZUl0ZW07XG5cblxuXHRQYWdlSXRlbSA9IHdwLm1lZGlhLlZpZXcuZXh0ZW5kKHtcblx0XHR0ZW1wbGF0ZTogIHdwLnRlbXBsYXRlKCdwZGYtcGFnZS1pdGVtJyksXG5cdFx0Y2xhc3NOYW1lOidwZGYtcGFnZS1pdGVtJyxcblx0XHRpbml0aWFsaXplOmZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHdwLm1lZGlhLlZpZXcucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO1xuXHRcdH0sXG5cdFx0cmVuZGVyOmZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHdwLm1lZGlhLlZpZXcucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7XG5cdFx0fVxuXHR9KTtcblxuXHRwZGZSZW5kZXJlci52aWV3LlBERkZyYW1lID0gd3AubWVkaWEudmlldy5NZWRpYUZyYW1lLmV4dGVuZCh7XG5cdFx0dGVtcGxhdGU6ICB3cC50ZW1wbGF0ZSgncGRmLW1vZGFsJyksXG5cdFx0cmVnaW9uczogICBbICd0aXRsZScsJ2NvbnRlbnQnLCdpbnN0cnVjdGlvbnMnLCdidXR0b25zJywgJ3BhZ2VuYXYnIF0sXG5cdFx0ZXZlbnRzOntcblx0XHRcdCdjbGljayBbZGF0YS1wYWdlXScgOiAnY2xpY2tQYWdlJ1xuXHRcdH0sXG5cdFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oICkge1xuXG5cblx0XHRcdF8uZGVmYXVsdHMoIHRoaXMub3B0aW9ucywge1xuXHRcdFx0XHR1cGxvYWRlcjpcdGZhbHNlLFxuXHRcdFx0XHR0aXRsZTpcdFx0bDEwbi5wZGZVcGxvYWQsXG5cdFx0XHR9KTtcblxuXHRcdFx0d3AubWVkaWEudmlldy5NZWRpYUZyYW1lLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtcblxuXHRcdFx0dGhpcy5fcGRmID0gdGhpcy5fY2FudmFzID0gbnVsbDtcblx0XHRcdHRoaXMuX2N1cnJlbnRfcGFnZSA9IDA7XG5cdFx0XHR0aGlzLl9wYWdlcyA9IHt9O1xuXG5cdFx0XHR0aGlzLmNyZWF0ZVRpdGxlKCk7XG5cdFx0XHR0aGlzLmNyZWF0ZUJ1dHRvbnMoKTtcblxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cblx0XHR9LFxuXHRcdGNyZWF0ZVRpdGxlOiBmdW5jdGlvbiggKSB7XG5cdFx0XHR0aGlzLl90aXRsZSA9IG5ldyB3cC5tZWRpYS5WaWV3KHtcblx0XHRcdFx0dGFnTmFtZTogJ2gxJ1xuXHRcdFx0fSk7XG5cdFx0XHR0aGlzLl90aXRsZS4kZWwudGV4dCggdGhpcy5vcHRpb25zLnRpdGxlICk7XG5cdFx0XHR0aGlzLnRpdGxlLnNldCggWyB0aGlzLl90aXRsZSBdICk7XG5cdFx0fSxcblx0XHRjcmVhdGVCdXR0b25zOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdHRoaXMuYnV0dG9ucy5zZXQoIFtcblx0XHRcdFx0bmV3IHdwLm1lZGlhLnZpZXcuQnV0dG9uKHtcblx0XHRcdFx0XHR0ZXh0OiBsMTBuLkNhbmNlbFVwbG9hZCxcblx0XHRcdFx0XHRjbGFzc05hbWU6ICdjYW5jZWwtdXBsb2FkJyxcblx0XHRcdFx0XHRjbGljazpmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHNlbGYudHJpZ2dlcignY2FuY2VsLXVwbG9hZCcpO1xuXHRcdFx0XHRcdFx0c2VsZi5jbG9zZSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSksXG5cdFx0XHRcdG5ldyB3cC5tZWRpYS52aWV3LkJ1dHRvbih7XG5cdFx0XHRcdFx0dGV4dDogbDEwbi5VcGxvYWRQREYsXG5cdFx0XHRcdFx0Y2xhc3NOYW1lOiAndXBsb2FkLXBkZicsXG5cdFx0XHRcdFx0Y2xpY2s6ZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHQvLyBkaXNtaXNzLCBjb250aW51ZSB3aXRoIHdwIGRlZnVhbHQgYmVoYXZpb3VyXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KSxcblx0XHRcdFx0bmV3IHdwLm1lZGlhLnZpZXcuQnV0dG9uKHtcblx0XHRcdFx0XHR0ZXh0OiBsMTBuLlVwbG9hZEltYWdlcyxcblx0XHRcdFx0XHRjbGFzc05hbWU6ICdidXR0b24tcHJpbWFyeScsXG5cdFx0XHRcdFx0Y2xpY2s6ZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRzZWxmLnRyaWdnZXIoJ2NhbmNlbC11cGxvYWQnKTtcblx0XHRcdFx0XHRcdHNlbGYudXBsb2FkSW1hZ2VzKCk7XG5cdFx0XHRcdFx0XHRzZWxmLmNsb3NlKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KVxuXHRcdFx0XSApO1xuXHRcdH0sXG5cdFx0c2V0RmlsZTpmdW5jdGlvbiggZmlsZSApIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRcdFx0ZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cdFx0XHR0aGlzLmZpbGUgPSBmaWxlO1xuXHRcdFx0ZmlsZVJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihldmVudCkge1xuLy9cdFx0XHQgICAgYXJyYXlCdWZmZXIgPSBldmVudC50YXJnZXQucmVzdWx0O1xuXHRcdFx0XHRzZWxmLnBhcnNlUERGKCBldmVudC50YXJnZXQucmVzdWx0ICk7XG5cdFx0XHR9O1xuXHRcdFx0ZmlsZVJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlciggZmlsZS5ibG9iICk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdGNsaWNrUGFnZTpmdW5jdGlvbihlKSB7XG5cdFx0XHR0aGlzLnNob3dQYWdlKCQoZS50YXJnZXQpLmF0dHIoJ2RhdGEtcGFnZScpKTtcblx0XHR9LFxuXHRcdHJlbmRlclBhZ2VOYXY6ZnVuY3Rpb24obnVtUGFnZXMpIHtcblx0XHRcdGNvbnNvbGUubG9nKClcblx0XHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRcdFx0aSA9IDEsIGJ0bnMgPSBbXTtcblx0XHRcdHRoaXMuX3BhZ2VzID0ge307XG5cdFx0XHRmb3IgKGk7aTw9bnVtUGFnZXM7aSsrKSB7XG5cdFx0XHRcdHRoaXMuX3BhZ2VzW2ldID0ge1xuXHRcdFx0XHRcdHBhZ2U6ZmFsc2UsXG5cdFx0XHRcdFx0Y2FudmFzOmZhbHNlLFxuXHRcdFx0XHRcdHNlbGVjdGVkOnRydWUsXG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8qXG5cdFx0XHRcdGJ0bnMucHVzaChcblx0XHRcdFx0XHRuZXcgUGFnZUl0ZW0oe1xuXHRcdFx0XHRcdFx0cGFnZW51bTppLFxuXHRcdFx0XHRcdFx0c2VsZWN0ZWQ6dHJ1ZSxcblx0XHRcdFx0XHRcdGV2ZW50czp7XG5cdFx0XHRcdFx0XHRcdCdjbGljaycgOiBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKCAkKGUudGFyZ2V0KS5pcygnLmRhc2hpY29ucycpICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0c2VsZi50b2dnbGVQYWdlKCB0aGlzLm9wdGlvbnMucGFnZW51bSApO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRzZWxmLnNob3dQYWdlKCB0aGlzLm9wdGlvbnMucGFnZW51bSApO1xuXHRcdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdCk7XG5cdFx0XHRcdC8qL1xuXHRcdFx0XHRidG5zLnB1c2goXG5cdFx0XHRcdFx0bmV3IHdwLm1lZGlhLnZpZXcuQnV0dG9uKHtcblx0XHRcdFx0XHRcdHRleHQ6ICcnLFxuXHRcdFx0XHRcdFx0Y2xhc3NOYW1lOiAnYnV0dG9uLXByaW1hcnkgZGFzaGljb25zLXllcyBkYXNoaWNvbnMnLFxuXHRcdFx0XHRcdFx0X3BhZ2U6aSxcblx0XHRcdFx0XHRcdGNsaWNrOmZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLnRvZ2dsZVBhZ2UodGhpcy5vcHRpb25zLl9wYWdlKTtcblx0XHRcdFx0XHRcdFx0dGhpcy4kZWwudG9nZ2xlQ2xhc3MoJ2J1dHRvbi1wcmltYXJ5JykubmV4dCgnYnV0dG9uJykudG9nZ2xlQ2xhc3MoJ2J1dHRvbi1wcmltYXJ5Jyk7XG5cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KS5yZW5kZXIoKVxuXHRcdFx0XHQpO1xuXG5cdFx0XHRcdGJ0bnMucHVzaChcblx0XHRcdFx0XHRuZXcgd3AubWVkaWEudmlldy5CdXR0b24oe1xuXHRcdFx0XHRcdFx0dGV4dDogaS50b1N0cmluZygpLFxuXHRcdFx0XHRcdFx0Y2xhc3NOYW1lOiAnYnV0dG9uLXByaW1hcnknLFxuXHRcdFx0XHRcdFx0X3BhZ2U6aSxcblx0XHRcdFx0XHRcdGNsaWNrOmZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLnNob3dQYWdlKHRoaXMub3B0aW9ucy5fcGFnZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSkucmVuZGVyKClcblx0XHRcdFx0KTtcblxuXHRcdFx0XHQvLyovXG5cdFx0XHR9XG5cdFx0XHR0aGlzLnBhZ2VuYXYuc2V0KCBidG5zICk7XG5cdFx0fSxcblx0XHRwYXJzZVBERjpmdW5jdGlvbiggYXJyICkge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0cGRmanNMaWIuZ2V0RG9jdW1lbnQoYXJyKS50aGVuKGZ1bmN0aW9uKHBkZikge1xuXHRcdFx0XHQvLyBidWlsZCBwYWdlcyBzZWxlY3RvclxuXHRcdFx0XHRzZWxmLl9wZGYgPSBwZGY7XG5cdFx0XHRcdHNlbGYucmVuZGVyUGFnZU5hdihwZGYubnVtUGFnZXMpXG5cblx0XHRcdFx0c2VsZi5zaG93UGFnZSgxKTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0dG9nZ2xlUGFnZTpmdW5jdGlvbihpZHgpIHtcblx0XHRcdHRoaXMuX3BhZ2VzW2lkeF0uc2VsZWN0ZWQgPSAhIHRoaXMuX3BhZ2VzW2lkeF0uc2VsZWN0ZWQ7XG5cdFx0XHRfLmVhY2godGhpcy5fcGFnZXMsIGZ1bmN0aW9uKGVsLGkpe1xuXHRcdFx0XHRjb25zb2xlLmxvZyhpLGVsKTtcblx0XHRcdH0pXG5cdFx0fSxcblx0XHRzaG93UGFnZTpmdW5jdGlvbihpZHgpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdGlmICggISEgdGhpcy5fcGFnZXNbaWR4XS5jYW52YXMgKSB7XG5cdFx0XHRcdHRoaXMuY29udGVudC5zZXQoIFtcblx0XHRcdFx0XHRuZXcgd3AubWVkaWEuVmlldyh7XG5cdFx0XHRcdFx0XHRlbDogdGhpcy5fcGFnZXNbaWR4XS5jYW52YXMsXG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0XSApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5yZW5kZXJQYWdlKCBpZHgsIGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0c2VsZi5zaG93UGFnZShpZHgpO1xuXHRcdFx0XHR9ICk7XG5cdFx0XHR9XG5cblx0XHR9LFxuXHRcdHJlbmRlclBhZ2U6ZnVuY3Rpb24oaWR4LGNiLGNiX2FyZ3MpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0c2VsZi5fcGRmLmdldFBhZ2UoaWR4KS50aGVuKGZ1bmN0aW9uKHBhZ2Upe1xuXHRcdFx0XHR2YXIgdnAgPSBwYWdlLmdldFZpZXdwb3J0KDEpLFxuXHRcdFx0XHRcdGNhbnZhcyA9ICQoJzxjYW52YXM+PC9jYW52YXM+JykuZ2V0KDApLFxuXHRcdFx0XHRcdGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXG5cdFx0XHRcdHZwID0gcGFnZS5nZXRWaWV3cG9ydCggb3B0cy5vcHRpb25zLmltYWdlX3dpZHRoIC8gdnAud2lkdGggKTtcblxuXHRcdFx0XHRjYW52YXMud2lkdGggPSB2cC53aWR0aDtcblx0XHRcdFx0Y2FudmFzLmhlaWdodCA9IHZwLmhlaWdodDtcblxuXHRcdFx0XHRwYWdlLnJlbmRlcih7XG5cdFx0XHRcdFx0Y2FudmFzQ29udGV4dDogY3R4LFxuXHRcdFx0XHRcdHZpZXdwb3J0OiB2cCxcblx0XHRcdFx0fSkudGhlbihmdW5jdGlvbigpe1xuXHRcdFx0XHRcdHNlbGYuX3BhZ2VzW2lkeF0ucGFnZSA9IHBhZ2U7XG5cdFx0XHRcdFx0c2VsZi5fcGFnZXNbaWR4XS5jYW52YXMgPSBjYW52YXM7XG5cblx0XHRcdFx0XHQhIWNiICYmIGNiLmFwcGx5KHNlbGYuX3BhZ2VzW2lkeF0sY2JfYXJnc3x8W10pO1xuLy9cdFx0XHRcdFx0c2VsZi5zaG93UGFnZShpZHgpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cblxuXHRcdHVwbG9hZEltYWdlczpmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRcdFx0dHlwZSA9ICdpbWFnZS9wbmcnLFxuXHRcdFx0XHR1cGxvYWQgPSBmdW5jdGlvbihuYW1lKXtcblx0XHRcdFx0XHQvKlxuXHRcdFx0XHRcdHRoaXMuY2FudmFzLnRvQmxvYihmdW5jdGlvbihibG9iKXtcblx0XHRcdFx0XHRcdGJsb2IubmFtZSA9IG5hbWU7XG5cdFx0XHRcdFx0XHRibG9iLnR5cGUgPSB0eXBlO1xuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coYmxvYi5uYW1lKVxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coc2VsZi5vcHRpb25zLnVwbG9hZGVyLGJsb2IpXG5cdFx0XHRcdFx0XHRzZWxmLm9wdGlvbnMudXBsb2FkZXIuYWRkRmlsZSggYmxvYiwgbmFtZSApO1xuXHRcdFx0XHRcdH0sdHlwZSk7XG5cdFx0XHRcdFx0LyovXG5cdFx0XHRcdFx0dmFyIGltZyA9IG5ldyBvLkltYWdlKCk7XG5cdFx0XHRcdFx0aW1nLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0aW1nLm5hbWUgPSBuYW1lO1xuXHRcdFx0XHRcdFx0aW1nLnR5cGUgPSB0eXBlO1xuXHRcdFx0XHRcdFx0c2VsZi5vcHRpb25zLnVwbG9hZGVyLmFkZEZpbGUoIGltZy5nZXRBc0Jsb2IoKSwgbmFtZSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpbWcubG9hZCggdGhpcy5jYW52YXMudG9EYXRhVVJMKHR5cGUpICk7XG5cdFx0XHRcdFx0Ly9cblx0XHRcdFx0XHQkKCdib2R5JykuYXBwZW5kKGltZyk7XG5cdFx0XHRcdH07XG5cblx0XHRcdC8vIGNyZWF0ZSBlIG5ldyBtZWRpYSBtb2RlbCBmcm9tIGJsb2IgZGF0YSBVUkwgdGhpbmd5XG5cdFx0XHRfLmVhY2godGhpcy5fcGFnZXMsZnVuY3Rpb24oIHBnLCBpICl7XG5cdFx0XHRcdHZhciBuYW1lID0gc2VsZi5maWxlLmZpbGUubmFtZS5yZXBsYWNlKC9cXC5bYS16MC05XSskLywnJykgKyAnLXAnICsgaSArICcucG5nJztcblx0XHRcdFx0aWYgKCAhIHBnLmNhbnZhcyApIHtcblx0XHRcdFx0XHQvLyBuZWVkcyByZW5kZXJpbmdcblx0XHRcdFx0XHRzZWxmLnJlbmRlclBhZ2UoaSoxLCB1cGxvYWQsW25hbWVdKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR1cGxvYWQuYXBwbHkocGcpXG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cblx0XHRcdC8vXG5cdFx0fVxuXHR9KTtcblxuXG5cdF8uZXh0ZW5kKCB3cC5tZWRpYS52aWV3LlVwbG9hZGVyV2luZG93LnByb3RvdHlwZSwge1xuXHRcdF9wYXJlbnRSZWFkeTogd3AubWVkaWEudmlldy5VcGxvYWRlcldpbmRvdy5wcm90b3R5cGUucmVhZHksXG5cdFx0ZGlkUmVhZHk6ZmFsc2UsXG5cblx0XHRyZWFkeTpmdW5jdGlvbigpIHtcblx0XHRcdHZhciBwZGZzID0gW10sXG5cdFx0XHRcdHBkZk1vZGFsLCBzZWxmID0gdGhpcztcblxuXHRcdFx0Ly8gcHJldmVudCBkb3VibGUgaW5pdFxuXHRcdFx0aWYgKCB0aGlzLmRpZFJlYWR5ICkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fcGFyZW50UmVhZHkuYXBwbHkoIHRoaXMgLCBhcmd1bWVudHMgKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuZGlkUmVhZHkgPSB0cnVlO1xuXG5cdFx0XHRyZXQgPSB0aGlzLl9wYXJlbnRSZWFkeS5hcHBseSggdGhpcyAsIGFyZ3VtZW50cyApO1xuXG5cdFx0XHRmdW5jdGlvbiBwZGZQb3B1cCggdXBsb2FkZXIgKSB7XG5cdFx0XHRcdHZhciBmaWxlSXRlbSwgc3JjO1xuXHRcdFx0XHRpZiAoIHBkZk1vZGFsICkge1xuXHRcdFx0XHRcdHBkZk1vZGFsLmNsb3NlKCkuZGlzcG9zZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggISEgcGRmcy5sZW5ndGggKSB7XG5cdFx0XHRcdFx0ZmlsZUl0ZW0gPSBwZGZzLnNoaWZ0KCk7XG5cdFx0XHRcdFx0cGRmTW9kYWwgPSBuZXcgcGRmUmVuZGVyZXIudmlldy5QREZGcmFtZSgge1xuXHRcdFx0XHRcdFx0Y29udHJvbGxlcjogJCh0aGlzKSxcblx0XHRcdFx0XHRcdHVwbG9hZGVyOnVwbG9hZGVyLFxuXHRcdFx0XHRcdFx0dGl0bGU6IGwxMG4uVXBsb2FkICsgJzogJyArIGZpbGVJdGVtLmZpbGUubmFtZS5yZXBsYWNlKC9cXC5bYS16MC05XSskLywnJyksXG5cdFx0XHRcdFx0fSApO1xuXHRcdFx0XHRcdHBkZk1vZGFsLm9uKCdwcm9jZWVkJyxmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdC8vIG5leHRcblx0XHRcdFx0XHRcdHBkZlBvcHVwKCB1cGxvYWRlciApO1xuXG5cdFx0XHRcdFx0fSkub24oJ2NhbmNlbC11cGxvYWQnLGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0ZmlsZUl0ZW0uZmlsZS5hdHRhY2htZW50LmRlc3Ryb3koKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRwZGZNb2RhbC5zZXRGaWxlKCBmaWxlSXRlbSApO1xuXHRcdFx0XHRcdHBkZk1vZGFsLm9wZW4oKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR1cGxvYWRlci5zdGFydCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGZ1bmN0aW9uIGFkZFBERiggZmlsZURhdGEsIHVwbG9hZGVyICkge1xuXG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICpcdEByZXR1cm4gbmF0aXZlIGZpbGUgb2JqZWN0IG9yIGJsb2Jcblx0XHRcdCAqL1xuXHRcdFx0ZnVuY3Rpb24gcmVzb2x2ZUZpbGUoIGZpbGUgKSB7XG5cdFx0XHRcdHZhciBfcmV0ID0ge1xuXHRcdFx0XHRcdGZpbGU6IGZpbGUsXG5cdFx0XHRcdFx0YmxvYjpmaWxlLmdldE5hdGl2ZSgpXG5cdFx0XHRcdH0sIF9yZXQyLCBieXRlcywgaTtcblx0XHRcdFx0aWYgKCAhIF9yZXQuYmxvYiApIHtcblx0XHRcdFx0XHRfcmV0LmJsb2IgPSBmaWxlLmdldFNvdXJjZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBfcmV0O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBzdG9wIHVwbG9hZGVyIGFuZCBnZW5lcmF0ZSBjcm9wZGF0YVxuXHRcdFx0dGhpcy51cGxvYWRlci51cGxvYWRlci5iaW5kKCdGaWxlc0FkZGVkJyxmdW5jdGlvbiggdXAsIGZpbGVzICkge1xuXHRcdFx0XHR2YXIgZmlsZURhdGE7XG5cdFx0XHRcdC8vIHB1dCBtb2RhbFxuXHRcdFx0XHRmb3IgKHZhciBpPTA7aTxmaWxlcy5sZW5ndGg7aSsrKSB7XG5cdFx0XHRcdFx0aWYgKCBmaWxlc1tpXS50eXBlID09ICdhcHBsaWNhdGlvbi9wZGYnKSB7XG5cdFx0XHRcdFx0XHRmaWxlRGF0YSA9IHJlc29sdmVGaWxlKCBmaWxlc1tpXSApO1xuXHRcdFx0XHRcdFx0aWYgKCBmaWxlRGF0YS5ibG9iIGluc3RhbmNlb2YgQmxvYiApIHtcblx0XHRcdFx0XHRcdFx0cGRmcy5wdXNoKCBmaWxlRGF0YSApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoIHBkZnMubGVuZ3RoICkge1xuXHRcdFx0XHRcdHVwLnN0b3AoKTtcblx0XHRcdFx0XHR1cC5yZWZyZXNoKCk7XG5cdFx0XHRcdFx0cGRmUG9wdXAoIHVwICk7IC8vIHdpbGwgYXNrIGZvciBmb2N1cyBvciBzdGFydCB1cGxvYWRlclxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdC8vIHNlbmQgY3JvcGRhdGFcblx0XHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnQmVmb3JlVXBsb2FkJyxmdW5jdGlvbiggdXAsIGZpbGUgKSB7XG5cdFx0XHRcdHZhciBzLCBjcm9wZGF0YSwgZm9jdXNwb2ludDtcblx0XHRcdFx0Ly8gZG8gc29tZXRoaW5nIHdpdGggZmlsZXMgYmVmb3JlIHVwbG9hZC4uLlxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gcmV0O1xuXHRcdH1cblx0fSk7XG5cbn0pKCBqUXVlcnksIHBkZl9yZW5kZXJlciwgbU94aWUgKTtcbiJdfQ==
